Fetching Pending Transactions:

Retrieve pending wire transactions from the TRANSACTION_EXCEPTION table with a filter on transaction type being "WIRE" and a limit of 30 records.
Looping Through Pending Transactions:

Iterate over the pending transaction exceptions.
If the transaction feed type is 'PD' (Payment Due), add the transaction IDs to a list named pd_pending_tran_ids.
Creating Reference Numbers:

Pass the pd_pending_tran_ids list to a function called create_reference_number_dict(), which returns three dictionaries: pending_reference_numbers, tran_id_mapping_with_refs, and tran_id_mapping_dr_cr.
In this function, iterate over each transaction ID in pd_pending_tran_ids.
Query the PD_TRANSACTION_INFO table for details related to the transaction ID.
If the query result is not None, create a bank_reference_account_number by concatenating the bankreference and account_number fields from the query result.
Populate the tran_id_mapping_dr_cr dictionary with the debit_credit_indicator from the query result and tran_id_mapping_with_refs with the bank_reference_account_number and tran_id.
Update the pending_reference_numbers dictionary with the bank_reference_account_number if it is not already present, using the post_date from the query result as the key.
Processing Pending References:

Call the process_pending_references() function with pd_pending_references, pd_mapping_with_refs, and "PD" as arguments.
In this function, iterate over the keys (transaction dates) of pd_pending_references.
For each reference number in pd_pending_reference_numbers[tran.date], split the reference number into bank_reference and account_no.
Retrieve the transaction ID (tran_id) from mapping_with_refs[reference number].
Call the wirecore_advice API endpoint with bank_reference and account_number.
Validate the response from the API. If it is successful, call the wire_advice_mapper function to map the response with transaction details, tran_date, bank_reference_number, and account_number.
Load the mapped data into the WireAdviceDetails table and return the wire advice reference ID for the inserted record.
Updating Tables:

Update the PDTransactionInfo and TransactionException tables with the reference number using the transaction ID and transaction type ("PD").
